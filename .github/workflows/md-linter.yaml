name: Lint and Check Markdown

on:
  pull_request:
    branches: [master, dev]
    # only trigger when the PR contains a markdown file
    paths: 
      - '**.md'
      - '**.markdown'

jobs:
  lint-and-check-markdown:    
      runs-on: ubuntu-latest
      steps:
        - name: Checkout Code
          uses: actions/checkout@v2
          with:
            fetch-depth: 0
        
        - name: Install npm
          uses: actions/setup-node@v2
          with:
            node-version: '16'

        - name: Install markdownlint-cli
          run: |
            npm install markdownlint-cli

        - name: Lint Markdown
          run: |
            node_modules/.bin/markdownlint -c .markdownlint.jsonc -i node_modules/ .
        
        # Check the links of the documents
        - name: Markdown Link Check
          uses: gaurav-nelson/github-action-markdown-link-check@v1
          with:
            check-modified-files-only: 'no' #todo make this dependent on label 
            config-file: .markdown-link-check.jsonc
            use-quiet-mode: 'yes'
